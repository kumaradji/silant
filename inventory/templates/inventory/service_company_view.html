{% extends 'inventory/base.html' %}
{% load static %}

{% block title %}Страница сервисной компании{% endblock %}

{% block content %}
<main>
    <section class="main-container">
        <div class="tabs">
            <button onclick="showTab('machines')" class="active">Машины</button>
            <button onclick="showTab('maintenances')">Техническое обслуживание</button>
            <button onclick="showTab('reclamations')">Рекламации</button>
        </div>

        <div id="machines" class="tab-content active">
            <h2>Машины</h2>
            <table>
                <thead>
                <tr>
                    <th><a href="?order_by=model_technique">Модель техники</a></th>
                    <th><a href="?order_by=serial_number">Зав. № машины</a></th>
                    <th><a href="?order_by=model_engine">Модель двигателя</a></th>
                    <th><a href="?order_by=model_transmission">Модель трансмиссии</a></th>
                    <th><a href="?order_by=model_drive_axle">Модель ведущего моста</a></th>
                    <th><a href="?order_by=model_steering_axle">Модель управляемого моста</a></th>
                    <th><a href="?order_by=shipment_date">Дата отгрузки с завода</a></th>
                </tr>
                </thead>
                <tbody>
                {% for machine in machines %}
                <tr onclick="location.href='{% url 'machine_detail' machine.id %}'">
                    <td>{{ machine.model_technique }}</td>
                    <td>{{ machine.serial_number }}</td>
                    <td>{{ machine.model_engine }}</td>
                    <td>{{ machine.model_transmission }}</td>
                    <td>{{ machine.model_drive_axle }}</td>
                    <td>{{ machine.model_steering_axle }}</td>
                    <td>{{ machine.shipment_date }}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <div id="maintenances" class="tab-content">
            <h2>Техническое обслуживание</h2>
            <table>
                <thead>
                <tr>
                    <th><a href="?order_by=machine__serial_number">Машина</a></th>
                    <th><a href="?order_by=maintenance_type">Вид ТО</a></th>
                    <th><a href="?order_by=maintenance_date">Дата проведения ТО</a></th>
                    <th><a href="?order_by=operating_time">Наработка, м/час</a></th>
                    <th><a href="?order_by=service_company__first_name">Сервисная компания</a></th>
                </tr>
                </thead>
                <tbody>
                {% for maintenance in maintenances %}
                <tr onclick="location.href='{% url 'maintenance_detail' maintenance.id %}'">
                    <td>{{ maintenance.machine.serial_number }}</td>
                    <td>{{ maintenance.maintenance_type }}</td>
                    <td>{{ maintenance.maintenance_date }}</td>
                    <td>{{ maintenance.operating_time }}</td>
                    <td>{{ maintenance.service_company.first_name }}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <div id="reclamations" class="tab-content">
            <h2>Рекламации</h2>
            <table>
                <thead>
                <tr>
                    <th><a href="?order_by=machine__serial_number">Машина</a></th>
                    <th><a href="?order_by=failure_date">Дата отказа</a></th>
                    <th><a href="?order_by=operating_time">Наработка, м/час</a></th>
                    <th><a href="?order_by=failure_unit">Узел отказа</a></th>
                    <th><a href="?order_by=recovery_method">Способ восстановления</a></th>
                    <th><a href="?order_by=service_company__first_name">Сервисная компания</a></th>
                </tr>
                </thead>
                <tbody>
                {% for reclamation in reclamations %}
                <tr onclick="location.href='{% url 'reclamation_detail' reclamation.id %}'">
                    <td>{{ reclamation.machine.serial_number }}</td>
                    <td>{{ reclamation.failure_date }}</td>
                    <td>{{ reclamation.operating_time }}</td>
                    <td>{{ reclamation.failure_unit }}</td>
                    <td>{{ reclamation.recovery_method }}</td>
                    <td>{{ reclamation.service_company.first_name }}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </section>
</main>

<script>
function showTab(tabId) {
    var tabs = document.getElementsByClassName('tab-content');
    for (var i = 0; i < tabs.length; i++) {
        tabs[i].style.display = 'none';
    }
    document.getElementById(tabId).style.display = 'block';
}

// Show the default tab
showTab('machines');

</script>
{% endblock %}
